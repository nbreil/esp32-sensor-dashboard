<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESP32 Sensor Dashboard</title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    
    <script>
        google.charts.load('current', {packages: ['corechart']});
        google.charts.setOnLoadCallback(fetchData);

        function fetchData() {
            let startDate = document.getElementById("startDate").value;
            let endDate = document.getElementById("endDate").value;

            let url = "YOUR_GOOGLE_SCRIPT_URL";
            if (startDate && endDate) {
                url += "?start=" + startDate + "&end=" + endDate;
            }

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    drawChart(data);
                })
                .catch(error => console.error("Error fetching data:", error));
        }

        function drawChart(sensorData) {
            var data = new google.visualization.DataTable();
            data.addColumn('datetime', 'Time');
            data.addColumn('number', 'Temperature (Â°C)');
            data.addColumn('number', 'Humidity (%)');

            for (var i = 1; i < sensorData.length; i++) {
                data.addRow([new Date(sensorData[i][0]), sensorData[i][1], sensorData[i][2]]);
            }

            var options = {
                title: 'Temperature & Humidity Data',
                curveType: 'function',
                legend: { position: 'bottom' },
                hAxis: { title: 'Time', format: 'MMM dd HH:mm' },
                vAxis: { title: 'Values' },
                series: {
                    0: { color: '#FF5733' }, // Temperature color
                    1: { color: '#337BFF' }  // Humidity color
                }
            };

            var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
            chart.draw(data, options);
        }
    </script>
</head>
<body>
    <h1>ESP32 Sensor Dashboard</h1>

    <label for="startDate">Start Date:</label>
    <input type="date" id="startDate">

    <label for="endDate">End Date:</label>
    <input type="date" id="endDate">

    <button onclick="fetchData()">Update Chart</button>

    <div id="chart_div" style="width: 100%; height: 500px;"></div>
</body>
</html>
